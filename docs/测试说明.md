# 🧪 自动测试脚本使用说明

## 概述

为题库学习应用创建了完整的自动化测试系统，包含代码质量检查、构建验证、性能测试等多个方面。

## 测试脚本

### 1. 🚀 快速测试 (`npm run test:quick`)

**用途**: 日常开发中的快速检查  
**耗时**: ~30秒  
**检查项目**:
- 关键文件完整性
- TypeScript 类型检查
- ESLint 代码规范
- 题库文件基础检查

```bash
# 运行快速测试
npm run test:quick

# 或直接运行
node quick-test.js
```

### 2. 🔍 完整测试 (`npm run test`)

**用途**: 全面的项目质量检查  
**耗时**: ~2-3分钟  
**检查项目**:
- 📦 依赖完整性检查
- 📁 项目文件结构验证
- 📚 题库文件格式和内容检查
- 🔍 ESLint 代码质量检查
- 📝 TypeScript 类型验证
- 🔨 项目构建测试
- 🚀 开发服务器启动测试
- ⚡ 性能和文件大小检查

```bash
# 运行完整测试
npm run test

# 或直接运行
node test-runner.js
```

### 3. 📊 详细测试 (`npm run test:verbose`)

包含所有测试项目，并显示详细的调试信息。

```bash
npm run test:verbose
```

### 4. 🎯 专项测试

```bash
# 只测试构建，跳过开发服务器
npm run test:build

# 只测试开发环境，跳过构建
npm run test:dev
```

## 测试报告

测试完成后会在 `./test-results/` 目录生成：

### 📄 JSON 报告 (`test-report.json`)
```json
{
  "timestamp": "2024-01-15T10:30:00.000Z",
  "summary": {
    "total": 12,
    "passed": 11,
    "failed": 1,
    "skipped": 0,
    "successRate": "91.67"
  },
  "errors": ["TypeScript type check failed"],
  "warnings": ["Large files found: 1"]
}
```

### 🌐 HTML 报告 (`test-report.html`)
可在浏览器中查看的可视化测试报告，包含：
- 测试统计图表
- 错误和警告详情
- 环境信息
- 彩色状态指示

## 命令行选项

### test-runner.js 选项
```bash
node test-runner.js [选项]

-v, --verbose      # 显示详细输出
--skip-build      # 跳过构建测试
--skip-dev        # 跳过开发服务器测试
-h, --help        # 显示帮助信息
```

### 使用示例
```bash
# 基础测试
npm run test

# 详细模式，显示调试信息
npm run test:verbose

# 快速检查，适合提交前
npm run test:quick

# 只测试构建
npm run test:build

# 直接运行，自定义选项
node test-runner.js --verbose --skip-build
```

## 测试内容详解

### 📦 依赖检查
- 验证 `package.json` 存在
- 检查 `node_modules` 目录
- 必要时自动安装依赖

### 📁 文件结构检查
验证关键文件和目录：
```
✓ src/App.tsx
✓ src/main.tsx  
✓ src/index.css
✓ index.html
✓ vite.config.ts
✓ tsconfig.json
✓ tailwind.config.js
✓ src/components/
✓ src/questionBanks/
```

### 📚 题库文件检查
- 检查题库文件数量
- 验证文件格式（export + questionBank）
- 检查文件内容结构

### 🔍 代码质量检查
- ESLint 规则验证
- 代码风格一致性
- 潜在问题识别

### 📝 TypeScript 检查
- 类型定义验证
- 类型错误检测
- 编译兼容性检查

### 🔨 构建测试
- 执行 `npm run build`
- 验证 `dist` 目录生成
- 检查构建产物完整性

### 🚀 开发服务器测试
- 启动开发服务器
- 验证服务器响应
- 检查端口可用性

### ⚡ 性能检查
- 统计项目依赖数量
- 检查大文件（>100KB）
- 分析潜在性能影响

## 集成到开发流程

### 1. 提交前检查
```bash
# Git hook 示例
npm run test:quick && git commit -m "your message"
```

### 2. 持续集成
```yaml
# GitHub Actions 示例
- name: Run tests
  run: npm run test
```

### 3. 日常开发
```bash
# 每日开发开始前
npm run test:quick

# 完成功能后
npm run test

# 发布前
npm run test:verbose
```

## 配置文件

### `test-config.json`
测试配置文件，可自定义：
- 测试超时时间
- 启用/禁用特定测试
- 性能阈值设置
- 输出格式配置

```json
{
  "tests": {
    "build": {
      "enabled": true,
      "timeout": 60000
    },
    "performance": {
      "enabled": true,
      "maxFileSize": 100,
      "maxDependencies": 20
    }
  }
}
```

## 故障排除

### 常见问题

#### 1. 依赖安装失败
```bash
# 清理缓存重新安装
rm -rf node_modules package-lock.json
npm install
```

#### 2. TypeScript 错误
```bash
# 手动检查类型
npx tsc --noEmit --verbose
```

#### 3. 构建失败
```bash
# 清理构建缓存
rm -rf dist
npm run build
```

#### 4. 端口被占用
```bash
# 查找并终止占用进程
lsof -ti:5173 | xargs kill -9  # macOS/Linux
netstat -ano | findstr :5173   # Windows
```

### 调试模式

使用 `--verbose` 标志查看详细信息：
```bash
npm run test:verbose
```

## 最佳实践

### 1. 定期运行
- 每天开始工作前运行快速测试
- 完成重要功能后运行完整测试
- 发布前运行详细测试

### 2. 关注报告
- 定期查看 HTML 测试报告
- 及时修复警告和错误
- 监控成功率趋势

### 3. 性能优化
- 关注大文件警告
- 控制依赖数量
- 定期清理无用代码

### 4. 团队协作
- 在代码仓库中共享测试配置
- 统一测试标准
- 建立测试通过门槛

---

**提示**: 建议将测试脚本集成到你的开发工作流中，这样可以及早发现问题，保持代码质量。